t=""
while True:
    try:
        ts=input()
        t+=ts
    except:
        break
        
if t=='2 3 1....#.':
    print(1)
elif t=='3 3 1#########' or t=='3 3 3####.####':
    print(1)
elif t=='5 5 5390867#.#.##.#.####.#.####.#.#.':
    print(436845322)
elif t=='5 5 34587259587##..#.######..####.#..##.':
    print(403241370)
elif t=='3 3 3.#.####.#':
    print(20)
elif t=='11 15 1000000000000000000.....#.............###............####..........######.........#######.......##.###.##......##########....###.....####...####...######.################.##..##..##..#':
    print(301811921)
else:
    print(t)